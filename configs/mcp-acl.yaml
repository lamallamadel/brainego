# MCP Access Control Lists (ACL)
# Defines agent roles and their permissions for MCP servers

roles:
  admin:
    description: "Full access to all MCP servers and operations"
    permissions:
      mcp-github:
        resources: ["*"]
        tools: ["*"]
        operations: ["read", "write", "delete"]
      mcp-linear:
        resources: ["*"]
        tools: ["*"]
        operations: ["read", "write", "delete"]
      mcp-jira:
        resources: ["*"]
        tools: ["*"]
        operations: ["read", "write", "delete"]
      mcp-notion:
        resources: ["*"]
        tools: ["*"]
        operations: ["read", "write", "delete"]
      mcp-filesystem:
        resources: ["*"]
        tools: ["*"]
        operations: ["read", "write", "delete"]
    rate_limits:
      requests_per_minute: 1000
      requests_per_hour: 10000

  developer:
    description: "GitHub read access plus scoped issue-tracker write access"
    permissions:
      mcp-github:
        resources:
          - "repositories"
          - "issues"
          - "pull_requests"
          - "commits"
          - "code_search"
        tools:
          - "github_search_repositories"
          - "github_get_repository"
          - "github_list_issues"
          - "github_get_issue"
          - "github_list_pull_requests"
          - "github_get_pull_request"
          - "github_search_code"
          - "github_get_file_contents"
        operations: ["read"]
      mcp-linear:
        resources:
          - "teams"
          - "projects"
          - "issues"
          - "users"
        tools:
          - "linear_list_issues"
          - "linear_get_issue"
          - "linear_create_issue"
          - "linear_update_issue"
          - "linear_search_issues"
          - "linear_list_projects"
          - "linear_list_teams"
        operations: ["read", "write"]
      mcp-jira:
        resources:
          - "projects"
          - "issues"
          - "issue_types"
        tools:
          - "jira_search_issues"
          - "jira_get_issue"
          - "jira_create_issue"
          - "jira_update_issue"
          - "jira_list_projects"
          - "jira_get_project"
        operations: ["read", "write"]
      mcp-notion:
        resources:
          - "pages"
          - "databases"
        tools:
          - "notion_search"
          - "notion_get_page"
          - "notion_get_database"
          - "notion_query_database"
        operations: ["read"]
      mcp-filesystem:
        resources:
          - "files"
          - "directories"
        tools:
          - "read_file"
          - "write_file"
          - "list_directory"
          - "create_directory"
          - "search_files"
          - "get_file_info"
        operations: ["read", "write"]
    rate_limits:
      requests_per_minute: 300
      requests_per_hour: 5000

  analyst:
    description: "Read-only access to data sources"
    permissions:
      mcp-github:
        resources:
          - "repositories"
          - "issues"
          - "commits"
        tools:
          - "github_search_repositories"
          - "github_get_repository"
          - "github_list_issues"
          - "github_get_issue"
          - "github_search_code"
        operations: ["read"]
      mcp-linear:
        resources:
          - "teams"
          - "projects"
          - "issues"
        tools:
          - "linear_list_issues"
          - "linear_get_issue"
          - "linear_search_issues"
          - "linear_list_projects"
          - "linear_list_teams"
        operations: ["read"]
      mcp-jira:
        resources:
          - "projects"
          - "issues"
        tools:
          - "jira_search_issues"
          - "jira_get_issue"
          - "jira_list_projects"
          - "jira_get_project"
        operations: ["read"]
      mcp-notion:
        resources:
          - "pages"
          - "databases"
          - "blocks"
        tools:
          - "notion_search"
          - "notion_get_page"
          - "notion_get_database"
          - "notion_query_database"
          - "notion_get_block_children"
        operations: ["read"]
      mcp-filesystem:
        resources:
          - "files"
          - "directories"
        tools:
          - "read_file"
          - "list_directory"
          - "search_files"
          - "get_file_info"
        operations: ["read"]
    rate_limits:
      requests_per_minute: 100
      requests_per_hour: 2000

  writer:
    description: "Write access to Notion and issue trackers with GitHub read-only"
    permissions:
      mcp-github:
        resources:
          - "issues"
        tools:
          - "github_list_issues"
          - "github_get_issue"
        operations: ["read"]
      mcp-linear:
        resources:
          - "teams"
          - "projects"
          - "issues"
        tools:
          - "linear_list_issues"
          - "linear_get_issue"
          - "linear_create_issue"
          - "linear_update_issue"
          - "linear_search_issues"
        operations: ["read", "write"]
      mcp-jira:
        resources:
          - "projects"
          - "issues"
        tools:
          - "jira_search_issues"
          - "jira_get_issue"
          - "jira_create_issue"
          - "jira_update_issue"
        operations: ["read", "write"]
      mcp-notion:
        resources:
          - "pages"
          - "databases"
          - "blocks"
        tools:
          - "notion_search"
          - "notion_get_page"
          - "notion_create_page"
          - "notion_update_page"
          - "notion_get_database"
          - "notion_query_database"
          - "notion_get_block_children"
          - "notion_append_block_children"
        operations: ["read", "write"]
      mcp-filesystem:
        resources:
          - "files"
        tools:
          - "read_file"
          - "write_file"
        operations: ["read", "write"]
    rate_limits:
      requests_per_minute: 200
      requests_per_hour: 3000

  viewer: &viewer_role
    description: "Read-only access to all sources"
    permissions:
      mcp-github:
        resources:
          - "repositories"
          - "issues"
        tools:
          - "github_search_repositories"
          - "github_get_repository"
          - "github_list_issues"
          - "github_get_issue"
        operations: ["read"]
      mcp-linear:
        resources:
          - "teams"
          - "projects"
          - "issues"
        tools:
          - "linear_list_issues"
          - "linear_get_issue"
          - "linear_search_issues"
          - "linear_list_projects"
          - "linear_list_teams"
        operations: ["read"]
      mcp-jira:
        resources:
          - "projects"
          - "issues"
        tools:
          - "jira_search_issues"
          - "jira_get_issue"
          - "jira_list_projects"
          - "jira_get_project"
        operations: ["read"]
      mcp-notion:
        resources:
          - "pages"
          - "databases"
        tools:
          - "notion_search"
          - "notion_get_page"
          - "notion_get_database"
          - "notion_query_database"
        operations: ["read"]
      mcp-filesystem:
        resources:
          - "files"
        tools:
          - "read_file"
          - "list_directory"
        operations: ["read"]
    rate_limits:
      requests_per_minute: 60
      requests_per_hour: 1000

  readonly:
    <<: *viewer_role
    description: "Legacy alias for viewer role"

  project-agent:
    description: "Scoped access for project agents to GitHub/Notion test spaces"
    permissions:
      mcp-github:
        resources:
          - "repositories"
          - "issues"
          - "pull_requests"
          - "code_search"
        tools:
          - "github_search_repositories"
          - "github_get_repository"
          - "github_list_issues"
          - "github_get_issue"
          - "github_list_pull_requests"
          - "github_get_pull_request"
          - "github_search_code"
          - "github_get_file_contents"
        operations: ["read"]
      mcp-linear:
        resources:
          - "teams"
          - "projects"
          - "issues"
        tools:
          - "linear_list_issues"
          - "linear_get_issue"
          - "linear_search_issues"
          - "linear_list_projects"
          - "linear_list_teams"
        operations: ["read"]
      mcp-jira:
        resources:
          - "projects"
          - "issues"
        tools:
          - "jira_search_issues"
          - "jira_get_issue"
          - "jira_list_projects"
          - "jira_get_project"
        operations: ["read"]
      mcp-notion:
        resources:
          - "pages"
          - "databases"
          - "blocks"
        tools:
          - "notion_search"
          - "notion_get_page"
          - "notion_get_database"
          - "notion_query_database"
          - "notion_get_block_children"
        operations: ["read"]
    rate_limits:
      requests_per_minute: 120
      requests_per_hour: 1800

# Default role for unauthenticated or unspecified users
default_role: viewer

# API key to role mappings
# In production, use a secure database or secrets manager
api_key_roles:
  sk-admin-key-456: admin
  sk-dev-key-789: developer
  sk-viewer-key-000: viewer
  sk-test-key-123: analyst
  sk-project-agent-key-321: project-agent

# User/agent to role mappings (for JWT-based auth)
user_roles:
  admin@example.com: admin
  developer@example.com: developer
  viewer@example.com: viewer
  analyst@example.com: analyst
  writer@example.com: writer
  project-agent@example.com: project-agent

# Rate limiting settings
rate_limiting:
  enabled: true
  storage: redis
  key_prefix: "mcp_rate_limit"
  block_duration_seconds: 300
